var $ba8f0fd94708c7d76569a51172698ace$exports = {};

var $ba8f0fd94708c7d76569a51172698ace$var$__importStar = $ba8f0fd94708c7d76569a51172698ace$exports && $ba8f0fd94708c7d76569a51172698ace$exports.__importStar || function (mod) {
  if (mod && mod.__esModule) return mod;
  var result = {};
  if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
  result["default"] = mod;
  return result;
};

Object.defineProperty($ba8f0fd94708c7d76569a51172698ace$exports, "__esModule", {
  value: true
}); // import GraphQLClient from "apollo-boost"

var $ba8f0fd94708c7d76569a51172698ace$var$react_1 = $ba8f0fd94708c7d76569a51172698ace$var$__importStar($parcel$require("ba8f0fd94708c7d76569a51172698ace", "react"));
var $ba8f0fd94708c7d76569a51172698ace$var$apollo_client_1 = $parcel$require("ba8f0fd94708c7d76569a51172698ace", "apollo-client");
var $ba8f0fd94708c7d76569a51172698ace$var$apollo_cache_inmemory_1 = $parcel$require("ba8f0fd94708c7d76569a51172698ace", "apollo-cache-inmemory");
var $ba8f0fd94708c7d76569a51172698ace$var$apollo_link_http_1 = $parcel$require("ba8f0fd94708c7d76569a51172698ace", "apollo-link-http");
var $ba8f0fd94708c7d76569a51172698ace$var$apollo_link_error_1 = $parcel$require("ba8f0fd94708c7d76569a51172698ace", "apollo-link-error");
var $ba8f0fd94708c7d76569a51172698ace$var$apollo_link_1 = $parcel$require("ba8f0fd94708c7d76569a51172698ace", "apollo-link");
var $ba8f0fd94708c7d76569a51172698ace$var$react_apollo_1 = $parcel$require("ba8f0fd94708c7d76569a51172698ace", "react-apollo");

var $ba8f0fd94708c7d76569a51172698ace$export$createClient = function (_a) {
  var LOCAL_STORAGE_JWT_TOKEN_KEY = _a.LOCAL_STORAGE_JWT_TOKEN_KEY,
      GRAPHQL_PRODUCTION_ENDPOINT = _a.GRAPHQL_PRODUCTION_ENDPOINT,
      GRAPHQL_TESTING_ENDPOINT = _a.GRAPHQL_TESTING_ENDPOINT,
      GRAPHQL_MOCKING_ENDPOINT = _a.GRAPHQL_MOCKING_ENDPOINT,
      _b = _a.AUTHORIZATION_HEADER,
      AUTHORIZATION_HEADER = _b === void 0 ? 'Authorization' : _b,
      _c = _a.AUTHORIZATION_SCHEME,
      AUTHORIZATION_SCHEME = _c === void 0 ? 'Bearer' : _c,
      _d = _a.mocking,
      mocking = _d === void 0 ? false : _d,
      _e = _a.alertOnError,
      alertOnError = _e === void 0 ? true : _e,
      _f = _a.disableCaching,
      disableCaching = _f === void 0 ? true : _f;
  var uri = mocking ? GRAPHQL_MOCKING_ENDPOINT : "production" === 'production' ? GRAPHQL_PRODUCTION_ENDPOINT : GRAPHQL_TESTING_ENDPOINT;
  var httpLink = new $ba8f0fd94708c7d76569a51172698ace$var$apollo_link_http_1.HttpLink({
    uri: uri
  });
  var authLink = new $ba8f0fd94708c7d76569a51172698ace$var$apollo_link_1.ApolloLink(function (operation, forward) {
    // Retrieve the authorization token from local storage.
    var token = localStorage.getItem(LOCAL_STORAGE_JWT_TOKEN_KEY);

    if (token && "production" !== 'production') {
      console.log('using jwt token ' + token + ' for graphql client');
    } // Use the setContext method to set the HTTP headers.


    var headers = {};

    if (token) {
      headers[AUTHORIZATION_HEADER] = AUTHORIZATION_SCHEME + " " + token;
    }

    operation.setContext({
      headers: headers
    }); // Call the next link in the middleware chain.

    return forward(operation);
  });
  var errorAlerter = $ba8f0fd94708c7d76569a51172698ace$var$apollo_link_error_1.onError(function (error) {
    var errors = error.graphQLErrors.map(function (_a) {
      var message = _a.message;
      return message;
    });
    var err = 'graphql error:\n' + JSON.stringify(errors, null, '    ');

    if (alertOnError) {
      alert(err);
    } else {
      console.error(err);
    }
  });
  var options = {
    link: $ba8f0fd94708c7d76569a51172698ace$var$apollo_link_1.ApolloLink.from([authLink, errorAlerter, httpLink]),
    cache: new $ba8f0fd94708c7d76569a51172698ace$var$apollo_cache_inmemory_1.InMemoryCache()
  };

  if (disableCaching) {
    options['defaultOptions'] = {
      watchQuery: {
        fetchPolicy: 'no-cache',
        errorPolicy: 'ignore'
      },
      query: {
        fetchPolicy: 'no-cache',
        errorPolicy: 'all'
      }
    };
  }

  return new $ba8f0fd94708c7d76569a51172698ace$var$apollo_client_1.ApolloClient(options);
};

$ba8f0fd94708c7d76569a51172698ace$exports.createClient = $ba8f0fd94708c7d76569a51172698ace$export$createClient;

var $ba8f0fd94708c7d76569a51172698ace$export$GraphqlProvider = function (_a) {
  var children = _a.children,
      LOCAL_STORAGE_JWT_TOKEN_KEY = _a.LOCAL_STORAGE_JWT_TOKEN_KEY,
      GRAPHQL_PRODUCTION_ENDPOINT = _a.GRAPHQL_PRODUCTION_ENDPOINT,
      GRAPHQL_TESTING_ENDPOINT = _a.GRAPHQL_TESTING_ENDPOINT,
      GRAPHQL_MOCKING_ENDPOINT = _a.GRAPHQL_MOCKING_ENDPOINT,
      _b = _a.AUTHORIZATION_HEADER,
      AUTHORIZATION_HEADER = _b === void 0 ? 'Authorization' : _b,
      _c = _a.AUTHORIZATION_SCHEME,
      AUTHORIZATION_SCHEME = _c === void 0 ? 'Bearer' : _c,
      _d = _a.mocking,
      mocking = _d === void 0 ? false : _d,
      _e = _a.alertOnError,
      alertOnError = _e === void 0 ? true : _e,
      _f = _a.disableCaching,
      disableCaching = _f === void 0 ? true : _f;

  var _g = $ba8f0fd94708c7d76569a51172698ace$var$react_1.useState(undefined),
      client = _g[0],
      setClient = _g[1];

  $ba8f0fd94708c7d76569a51172698ace$var$react_1.useLayoutEffect(function () {
    setClient($ba8f0fd94708c7d76569a51172698ace$exports.createClient({
      LOCAL_STORAGE_JWT_TOKEN_KEY: LOCAL_STORAGE_JWT_TOKEN_KEY,
      GRAPHQL_PRODUCTION_ENDPOINT: GRAPHQL_PRODUCTION_ENDPOINT,
      GRAPHQL_TESTING_ENDPOINT: GRAPHQL_TESTING_ENDPOINT,
      GRAPHQL_MOCKING_ENDPOINT: GRAPHQL_MOCKING_ENDPOINT,
      AUTHORIZATION_HEADER: AUTHORIZATION_HEADER,
      AUTHORIZATION_SCHEME: AUTHORIZATION_SCHEME,
      mocking: mocking,
      alertOnError: alertOnError,
      disableCaching: disableCaching
    }));
  }, []);

  if (client) {
    return $ba8f0fd94708c7d76569a51172698ace$var$react_1.default.createElement($ba8f0fd94708c7d76569a51172698ace$var$react_apollo_1.ApolloProvider, {
      client: client
    }, children);
  } else {
    return $ba8f0fd94708c7d76569a51172698ace$var$react_1.default.createElement($ba8f0fd94708c7d76569a51172698ace$var$react_1.default.Fragment, null);
  }
};

$ba8f0fd94708c7d76569a51172698ace$exports.GraphqlProvider = $ba8f0fd94708c7d76569a51172698ace$export$GraphqlProvider;